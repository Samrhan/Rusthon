---
source: tests/default_arguments.rs
expression: llvm_ir
---
; ModuleID = 'main'
source_filename = "main"

@int_format_string.4 = private unnamed_addr constant [4 x i8] c"%d\0A\00", align 1
@float_format_string.5 = private unnamed_addr constant [4 x i8] c"%f\0A\00", align 1

; Function Attrs: mustprogress nofree nounwind willreturn
define i64 @add(i64 %0, i64 %1, i64 %2) local_unnamed_addr #0 {
entry:
  %3 = and i64 %0, 1970324836974592
  %is_list = icmp ne i64 %3, 844424930131968
  %4 = and i64 %1, 1970324836974592
  %is_list9 = icmp ne i64 %4, 844424930131968
  %5 = and i64 %0, 9222809086901354496
  %6 = icmp eq i64 %5, 9221683186994511872
  %lhs_is_string = and i1 %is_list, %6
  %7 = and i64 %1, 9222809086901354496
  %8 = icmp eq i64 %7, 9221683186994511872
  %rhs_is_string = and i1 %is_list9, %8
  %both_strings = and i1 %lhs_is_string, %rhs_is_string
  br i1 %both_strings, label %str_concat, label %arithmetic

str_concat:                                       ; preds = %entry
  %extract_ptr_payload = and i64 %0, 281474976710655
  %payload_to_ptr = inttoptr i64 %extract_ptr_payload to ptr
  %extract_ptr_payload14 = and i64 %1, 281474976710655
  %payload_to_ptr15 = inttoptr i64 %extract_ptr_payload14 to ptr
  %lhs_len = tail call i64 @strlen(ptr noundef nonnull dereferenceable(1) %payload_to_ptr)
  %rhs_len = tail call i64 @strlen(ptr noundef nonnull dereferenceable(1) %payload_to_ptr15)
  %total_len = add i64 %rhs_len, 1
  %total_size = add i64 %total_len, %lhs_len
  %malloc_concat = tail call ptr @malloc(i64 %total_size)
  tail call void @llvm.memcpy.p0.p0.i64(ptr align 1 %malloc_concat, ptr align 1 %payload_to_ptr, i64 %lhs_len, i1 false)
  %rhs_dest = getelementptr i8, ptr %malloc_concat, i64 %lhs_len
  tail call void @llvm.memcpy.p0.p0.i64(ptr align 1 %rhs_dest, ptr align 1 %payload_to_ptr15, i64 %total_len, i1 false)
  %ptr_to_int = ptrtoint ptr %malloc_concat to i64
  %ptr_payload = and i64 %ptr_to_int, 281474976710655
  %pyobject_string = or disjoint i64 %ptr_payload, 9221683186994511872
  br label %add_merge

arithmetic:                                       ; preds = %entry
  %check_qnan3 = and i64 %1, 9221120237041090560
  %is_float4.not.not = icmp eq i64 %check_qnan3, 9221120237041090560
  %check_qnan = and i64 %0, 9221120237041090560
  %is_float.not.not = icmp eq i64 %check_qnan, 9221120237041090560
  %i64_to_f64 = bitcast i64 %0 to double
  %extract_payload = and i64 %0, 281474976710655
  %is_negative.not = icmp ult i64 %extract_payload, 140737488355328
  %masksel = select i1 %is_negative.not, i64 0, i64 -281474976710656
  %signed_payload = or disjoint i64 %masksel, %extract_payload
  %payload_to_f64 = sitofp i64 %signed_payload to double
  %final_payload = select i1 %is_float.not.not, double %payload_to_f64, double %i64_to_f64
  %i64_to_f6420 = bitcast i64 %1 to double
  %extract_payload21 = and i64 %1, 281474976710655
  %is_negative23.not = icmp ult i64 %extract_payload21, 140737488355328
  %masksel116 = select i1 %is_negative23.not, i64 0, i64 -281474976710656
  %signed_payload25 = or disjoint i64 %masksel116, %extract_payload21
  %payload_to_f6426 = sitofp i64 %signed_payload25 to double
  %final_payload27 = select i1 %is_float4.not.not, double %payload_to_f6426, double %i64_to_f6420
  %9 = and i64 %check_qnan, %1
  %result_is_float.not = icmp eq i64 %9, 9221120237041090560
  %addtmp = fadd double %final_payload, %final_payload27
  %float_to_i64 = bitcast double %addtmp to i64
  %payload_to_i64 = fptosi double %addtmp to i64
  %payload_masked = and i64 %payload_to_i64, 281474976710655
  %nanboxed = or disjoint i64 %payload_masked, 9221120237041090560
  %pyobject = select i1 %result_is_float.not, i64 %nanboxed, i64 %float_to_i64
  br label %add_merge

add_merge:                                        ; preds = %arithmetic, %str_concat
  %add_result = phi i64 [ %pyobject_string, %str_concat ], [ %pyobject, %arithmetic ]
  %10 = and i64 %add_result, 1970324836974592
  %is_list38 = icmp ne i64 %10, 844424930131968
  %check_qnan43 = and i64 %2, 9221120237041090560
  %is_float44.not = icmp eq i64 %check_qnan43, 9221120237041090560
  %11 = and i64 %2, 1970324836974592
  %is_list49 = icmp ne i64 %11, 844424930131968
  %12 = and i64 %add_result, 9222809086901354496
  %13 = icmp eq i64 %12, 9221683186994511872
  %lhs_is_string54 = and i1 %is_list38, %13
  %14 = and i64 %2, 1688849860263936
  %rhs_is_string55131132 = icmp eq i64 %14, 562949953421312
  %rhs_is_string55131 = and i1 %is_list49, %rhs_is_string55131132
  %rhs_is_string55 = select i1 %is_float44.not, i1 %rhs_is_string55131, i1 false
  %both_strings56 = and i1 %rhs_is_string55, %lhs_is_string54
  br i1 %both_strings56, label %str_concat57, label %arithmetic58

str_concat57:                                     ; preds = %add_merge
  %extract_ptr_payload60 = and i64 %add_result, 281474976710655
  %payload_to_ptr61 = inttoptr i64 %extract_ptr_payload60 to ptr
  %extract_ptr_payload62 = and i64 %2, 281474976710655
  %payload_to_ptr63 = inttoptr i64 %extract_ptr_payload62 to ptr
  %lhs_len64 = tail call i64 @strlen(ptr noundef nonnull dereferenceable(1) %payload_to_ptr61)
  %rhs_len65 = tail call i64 @strlen(ptr noundef nonnull dereferenceable(1) %payload_to_ptr63)
  %total_len66 = add i64 %rhs_len65, 1
  %total_size67 = add i64 %total_len66, %lhs_len64
  %malloc_concat68 = tail call ptr @malloc(i64 %total_size67)
  tail call void @llvm.memcpy.p0.p0.i64(ptr align 1 %malloc_concat68, ptr align 1 %payload_to_ptr61, i64 %lhs_len64, i1 false)
  %rhs_dest70 = getelementptr i8, ptr %malloc_concat68, i64 %lhs_len64
  tail call void @llvm.memcpy.p0.p0.i64(ptr align 1 %rhs_dest70, ptr align 1 %payload_to_ptr63, i64 %total_len66, i1 false)
  %ptr_to_int73 = ptrtoint ptr %malloc_concat68 to i64
  %ptr_payload74 = and i64 %ptr_to_int73, 281474976710655
  %pyobject_string75 = or disjoint i64 %ptr_payload74, 9221683186994511872
  br label %add_merge59

arithmetic58:                                     ; preds = %add_merge
  %check_qnan32 = and i64 %add_result, 9221120237041090560
  %is_float33.not = icmp eq i64 %check_qnan32, 9221120237041090560
  %i64_to_f6478 = bitcast i64 %add_result to double
  %extract_payload79 = and i64 %add_result, 281474976710655
  %is_negative81.not = icmp ult i64 %extract_payload79, 140737488355328
  %masksel125 = select i1 %is_negative81.not, i64 0, i64 -281474976710656
  %signed_payload83 = or disjoint i64 %masksel125, %extract_payload79
  %payload_to_f6484 = sitofp i64 %signed_payload83 to double
  %final_payload85 = select i1 %is_float33.not, double %payload_to_f6484, double %i64_to_f6478
  %i64_to_f6488 = bitcast i64 %2 to double
  %extract_payload89 = and i64 %2, 281474976710655
  %is_negative91.not = icmp ult i64 %extract_payload89, 140737488355328
  %masksel126 = select i1 %is_negative91.not, i64 0, i64 -281474976710656
  %signed_payload93 = or disjoint i64 %masksel126, %extract_payload89
  %payload_to_f6494 = sitofp i64 %signed_payload93 to double
  %final_payload95 = select i1 %is_float44.not, double %payload_to_f6494, double %i64_to_f6488
  %15 = and i64 %check_qnan43, %add_result
  %result_is_float98.not = icmp eq i64 %15, 9221120237041090560
  %addtmp99 = fadd double %final_payload95, %final_payload85
  %float_to_i64102 = bitcast double %addtmp99 to i64
  %payload_to_i64109 = fptosi double %addtmp99 to i64
  %payload_masked110 = and i64 %payload_to_i64109, 281474976710655
  %nanboxed113 = or disjoint i64 %payload_masked110, 9221120237041090560
  %pyobject114 = select i1 %result_is_float98.not, i64 %nanboxed113, i64 %float_to_i64102
  br label %add_merge59

add_merge59:                                      ; preds = %arithmetic58, %str_concat57
  %add_result115 = phi i64 [ %pyobject_string75, %str_concat57 ], [ %pyobject114, %arithmetic58 ]
  ret i64 %add_result115
}

; Function Attrs: mustprogress nofree nounwind willreturn memory(argmem: read)
declare i64 @strlen(ptr nocapture) local_unnamed_addr #1

; Function Attrs: mustprogress nofree nounwind willreturn allockind("alloc,uninitialized") allocsize(0) memory(inaccessiblemem: readwrite)
declare noalias noundef ptr @malloc(i64 noundef) local_unnamed_addr #2

; Function Attrs: nofree nounwind
define noundef i32 @main() local_unnamed_addr #3 {
entry:
  %calltmp = tail call i64 @add(i64 9221120237041090565, i64 9221120237041090570, i64 9221120237041090580)
  %check_qnan = and i64 %calltmp, 9221120237041090560
  %is_float.not = icmp eq i64 %check_qnan, 9221120237041090560
  %tag_bits = lshr i64 %calltmp, 48
  %tag = and i64 %tag_bits, 7
  %is_bool = icmp eq i64 %tag, 1
  %is_string = icmp eq i64 %tag, 2
  %is_list = icmp eq i64 %tag, 3
  %0 = trunc i64 %tag_bits to i3
  %1 = select i1 %is_bool, i3 2, i3 %0
  %2 = select i1 %is_string, i3 3, i3 %1
  %3 = select i1 %is_list, i3 -4, i3 %2
  %i64_to_f64 = bitcast i64 %calltmp to double
  %extract_payload = and i64 %calltmp, 281474976710655
  %is_negative.not = icmp ult i64 %extract_payload, 140737488355328
  %masksel = select i1 %is_negative.not, i64 0, i64 -281474976710656
  %signed_payload = or disjoint i64 %masksel, %extract_payload
  %payload_to_f64 = sitofp i64 %signed_payload to double
  %final_payload = select i1 %is_float.not, double %payload_to_f64, double %i64_to_f64
  %trunc = select i1 %is_float.not, i3 %3, i3 1
  switch i3 %trunc, label %print_float [
    i3 3, label %print_string
    i3 0, label %print_int
  ]

print_int:                                        ; preds = %entry
  %to_int = fptosi double %final_payload to i64
  %printf_int = tail call i32 (ptr, ...) @printf(ptr nonnull dereferenceable(1) @int_format_string.4, i64 %to_int)
  br label %print_end

print_float:                                      ; preds = %entry
  %printf_float = tail call i32 (ptr, ...) @printf(ptr nonnull dereferenceable(1) @float_format_string.5, double %final_payload)
  br label %print_end

print_string:                                     ; preds = %entry
  %payload_to_ptr = inttoptr i64 %extract_payload to ptr
  %puts = tail call i32 @puts(ptr nonnull dereferenceable(1) %payload_to_ptr)
  br label %print_end

print_end:                                        ; preds = %print_string, %print_float, %print_int
  %calltmp4 = tail call i64 @add(i64 9221120237041090565, i64 9221120237041090575, i64 9221120237041090580)
  %check_qnan5 = and i64 %calltmp4, 9221120237041090560
  %is_float6.not = icmp eq i64 %check_qnan5, 9221120237041090560
  %tag_bits7 = lshr i64 %calltmp4, 48
  %tag8 = and i64 %tag_bits7, 7
  %is_bool9 = icmp eq i64 %tag8, 1
  %is_string10 = icmp eq i64 %tag8, 2
  %is_list11 = icmp eq i64 %tag8, 3
  %4 = trunc i64 %tag_bits7 to i3
  %5 = select i1 %is_bool9, i3 2, i3 %4
  %6 = select i1 %is_string10, i3 3, i3 %5
  %7 = select i1 %is_list11, i3 -4, i3 %6
  %i64_to_f6418 = bitcast i64 %calltmp4 to double
  %extract_payload19 = and i64 %calltmp4, 281474976710655
  %is_negative21.not = icmp ult i64 %extract_payload19, 140737488355328
  %masksel74 = select i1 %is_negative21.not, i64 0, i64 -281474976710656
  %signed_payload23 = or disjoint i64 %masksel74, %extract_payload19
  %payload_to_f6424 = sitofp i64 %signed_payload23 to double
  %final_payload25 = select i1 %is_float6.not, double %payload_to_f6424, double %i64_to_f6418
  %trunc75 = select i1 %is_float6.not, i3 %7, i3 1
  switch i3 %trunc75, label %print_float30 [
    i3 3, label %print_string31
    i3 0, label %print_int29
  ]

print_int29:                                      ; preds = %print_end
  %to_int33 = fptosi double %final_payload25 to i64
  %printf_int34 = tail call i32 (ptr, ...) @printf(ptr nonnull dereferenceable(1) @int_format_string.4, i64 %to_int33)
  br label %print_end32

print_float30:                                    ; preds = %print_end
  %printf_float35 = tail call i32 (ptr, ...) @printf(ptr nonnull dereferenceable(1) @float_format_string.5, double %final_payload25)
  br label %print_end32

print_string31:                                   ; preds = %print_end
  %payload_to_ptr37 = inttoptr i64 %extract_payload19 to ptr
  %puts76 = tail call i32 @puts(ptr nonnull dereferenceable(1) %payload_to_ptr37)
  br label %print_end32

print_end32:                                      ; preds = %print_string31, %print_float30, %print_int29
  %calltmp39 = tail call i64 @add(i64 9221120237041090565, i64 9221120237041090575, i64 9221120237041090585)
  %check_qnan40 = and i64 %calltmp39, 9221120237041090560
  %is_float41.not = icmp eq i64 %check_qnan40, 9221120237041090560
  %tag_bits42 = lshr i64 %calltmp39, 48
  %tag43 = and i64 %tag_bits42, 7
  %is_bool44 = icmp eq i64 %tag43, 1
  %is_string45 = icmp eq i64 %tag43, 2
  %is_list46 = icmp eq i64 %tag43, 3
  %8 = trunc i64 %tag_bits42 to i3
  %9 = select i1 %is_bool44, i3 2, i3 %8
  %10 = select i1 %is_string45, i3 3, i3 %9
  %11 = select i1 %is_list46, i3 -4, i3 %10
  %i64_to_f6453 = bitcast i64 %calltmp39 to double
  %extract_payload54 = and i64 %calltmp39, 281474976710655
  %is_negative56.not = icmp ult i64 %extract_payload54, 140737488355328
  %masksel77 = select i1 %is_negative56.not, i64 0, i64 -281474976710656
  %signed_payload58 = or disjoint i64 %masksel77, %extract_payload54
  %payload_to_f6459 = sitofp i64 %signed_payload58 to double
  %final_payload60 = select i1 %is_float41.not, double %payload_to_f6459, double %i64_to_f6453
  %trunc78 = select i1 %is_float41.not, i3 %11, i3 1
  switch i3 %trunc78, label %print_float65 [
    i3 3, label %print_string66
    i3 0, label %print_int64
  ]

print_int64:                                      ; preds = %print_end32
  %to_int68 = fptosi double %final_payload60 to i64
  %printf_int69 = tail call i32 (ptr, ...) @printf(ptr nonnull dereferenceable(1) @int_format_string.4, i64 %to_int68)
  br label %print_end67

print_float65:                                    ; preds = %print_end32
  %printf_float70 = tail call i32 (ptr, ...) @printf(ptr nonnull dereferenceable(1) @float_format_string.5, double %final_payload60)
  br label %print_end67

print_string66:                                   ; preds = %print_end32
  %payload_to_ptr72 = inttoptr i64 %extract_payload54 to ptr
  %puts79 = tail call i32 @puts(ptr nonnull dereferenceable(1) %payload_to_ptr72)
  br label %print_end67

print_end67:                                      ; preds = %print_string66, %print_float65, %print_int64
  ret i32 0
}

; Function Attrs: nofree nounwind
declare noundef i32 @printf(ptr nocapture noundef readonly, ...) local_unnamed_addr #3

; Function Attrs: nocallback nofree nounwind willreturn memory(argmem: readwrite)
declare void @llvm.memcpy.p0.p0.i64(ptr noalias nocapture writeonly, ptr noalias nocapture readonly, i64, i1 immarg) #4

; Function Attrs: nofree nounwind
declare noundef i32 @puts(ptr nocapture noundef readonly) local_unnamed_addr #3

attributes #0 = { mustprogress nofree nounwind willreturn }
attributes #1 = { mustprogress nofree nounwind willreturn memory(argmem: read) }
attributes #2 = { mustprogress nofree nounwind willreturn allockind("alloc,uninitialized") allocsize(0) memory(inaccessiblemem: readwrite) "alloc-family"="malloc" }
attributes #3 = { nofree nounwind }
attributes #4 = { nocallback nofree nounwind willreturn memory(argmem: readwrite) }
